definitions:
  models.Config:
    properties:
      any_select:
        type: boolean
      created_at:
        description: Automatically managed by GORM for creation time
        type: string
      enable_ai:
        description: 是否启用AI功能，默认开启
        type: boolean
      id:
        type: integer
      image_pull_timeout:
        description: 镜像拉取超时时间（秒）
        type: integer
      jwt_token_secret:
        type: string
      kubectl_shell_image:
        type: string
      login_type:
        type: string
      max_history:
        description: 模型对话上下文历史记录数
        type: integer
      max_iterations:
        description: 模型自动对话的最大轮数
        type: integer
      model_id:
        type: integer
      node_shell_image:
        type: string
      print_config:
        type: boolean
      product_name:
        description: 产品名称
        type: string
      resource_cache_timeout:
        description: 资源缓存时间（秒）
        type: integer
      updated_at:
        description: Automatically managed by GORM for update time
        type: string
      use_built_in_model:
        type: boolean
    type: object
  models.User:
    properties:
      created_at:
        type: string
      disabled:
        description: 是否启用
        type: boolean
      group_names:
        type: string
      id:
        type: integer
      password:
        type: string
      salt:
        type: string
      source:
        description: 来源，如：db, ldap, oauth
        type: string
      two_fa_app_name:
        description: 2FA应用名称，用于提醒用户使用的是哪个软件
        type: string
      two_fa_backup_codes:
        description: 备用恢复码，逗号分隔
        type: string
      two_fa_enabled:
        description: 是否启用2FA
        type: boolean
      two_fa_secret:
        description: 2FA密钥
        type: string
      two_fa_type:
        description: 2FA类型：如 'totp', 'sms', 'email'
        type: string
      updated_at:
        description: Automatically managed by GORM for update time
        type: string
      username:
        type: string
    type: object
  models.UserGroup:
    properties:
      created_at:
        type: string
      description:
        type: string
      group_name:
        type: string
      id:
        type: integer
      role:
        description: 管理员/只读
        type: string
      updated_at:
        type: string
    type: object
info:
  contact: {}
  description: 请输入以 `Bearer ` 开头的 Token，例：Bearer xxxxxxxx。未列出接口请参考前端调用方法。
  title: k8m API
  version: "1.0"
paths:
  /admin/ai/model/delete/{ids}:
    post:
      parameters:
      - description: 模型ID，多个用逗号分隔
        in: path
        name: ids
        required: true
        type: string
      responses:
        "200":
          description: OK
          schema:
            type: string
      security:
      - BearerAuth: []
      summary: 删除AI模型配置
  /admin/ai/model/id/{id}/think/{status}:
    post:
      parameters:
      - description: 模型ID
        in: path
        name: id
        required: true
        type: integer
      - description: 状态，例如：true、false
        in: path
        name: status
        required: true
        type: string
      responses:
        "200":
          description: OK
          schema:
            type: string
      security:
      - BearerAuth: []
      summary: 快速保存AI模型思考状态
  /admin/ai/model/list:
    get:
      responses:
        "200":
          description: OK
          schema:
            type: string
      security:
      - BearerAuth: []
      summary: 获取AI模型配置列表
  /admin/ai/model/save:
    post:
      responses:
        "200":
          description: OK
          schema:
            type: string
      security:
      - BearerAuth: []
      summary: 创建或更新AI模型配置
  /admin/ai/model/test/id/{id}:
    post:
      parameters:
      - description: 模型ID
        in: path
        name: id
        required: true
        type: integer
      responses:
        "200":
          description: OK
          schema:
            type: string
      security:
      - BearerAuth: []
      summary: 测试AI模型连接
  /admin/cluster/{cluster}/disconnect:
    post:
      description: 断开一个正在运行的集群的连接
      parameters:
      - description: Base64编码的集群ID
        in: path
        name: cluster
        required: true
        type: string
      responses:
        "200":
          description: 已执行，请稍后刷新
          schema:
            type: string
      security:
      - BearerAuth: []
      summary: 断开集群连接
  /admin/cluster/{cluster}/reconnect:
    post:
      description: 重新连接一个已断开的集群
      parameters:
      - description: Base64编码的集群ID
        in: path
        name: cluster
        required: true
        type: string
      responses:
        "200":
          description: 已执行，请稍后刷新
          schema:
            type: string
      security:
      - BearerAuth: []
      summary: 重新连接集群
  /admin/cluster/file/option_list:
    get:
      description: 获取所有已发现集群的kubeconfig文件名列表，用于下拉选项
      responses:
        "200":
          description: OK
          schema:
            type: string
      security:
      - BearerAuth: []
      summary: 获取文件类型的集群选项
  /admin/cluster/kubeconfig/remove:
    post:
      description: 从数据库中删除KubeConfig配置
      responses:
        "200":
          description: OK
          schema:
            type: string
      security:
      - BearerAuth: []
      summary: 删除KubeConfig
  /admin/cluster/kubeconfig/save:
    post:
      description: 保存KubeConfig配置到数据库
      responses:
        "200":
          description: OK
          schema:
            type: string
      security:
      - BearerAuth: []
      summary: 保存KubeConfig
  /admin/cluster/scan:
    post:
      description: 扫描本地Kubeconfig文件目录以发现新的集群
      responses:
        "200":
          description: OK
          schema:
            type: string
      security:
      - BearerAuth: []
      summary: 扫描集群
  /admin/cluster_permissions/cluster/{cluster}/list:
    get:
      parameters:
      - description: 集群ID(base64)
        in: path
        name: cluster
        required: true
        type: string
      responses:
        "200":
          description: OK
          schema:
            type: string
      security:
      - BearerAuth: []
      summary: 获取指定集群下所有用户的权限角色列表
  /admin/cluster_permissions/cluster/{cluster}/ns/list:
    get:
      parameters:
      - description: 集群ID(base64)
        in: path
        name: cluster
        required: true
        type: string
      responses:
        "200":
          description: OK
          schema:
            type: string
      security:
      - BearerAuth: []
      summary: 获取指定集群下所有命名空间名称
  /admin/cluster_permissions/cluster/{cluster}/role/{role}/{authorization_type}/save:
    post:
      parameters:
      - description: 集群ID(base64)
        in: path
        name: cluster
        required: true
        type: string
      - description: 角色
        in: path
        name: role
        required: true
        type: string
      - description: 授权类型
        in: path
        name: authorization_type
        required: true
        type: string
      responses:
        "200":
          description: OK
          schema:
            type: string
      security:
      - BearerAuth: []
      summary: 批量为指定集群添加用户角色权限
  /admin/cluster_permissions/cluster/{cluster}/role/{role}/user/list:
    get:
      parameters:
      - description: 集群ID(base64)
        in: path
        name: cluster
        required: true
        type: string
      - description: 角色
        in: path
        name: role
        required: true
        type: string
      responses:
        "200":
          description: OK
          schema:
            type: string
      security:
      - BearerAuth: []
      summary: 获取指定集群指定角色的用户权限列表
  /admin/cluster_permissions/delete/{ids}:
    post:
      parameters:
      - description: 权限ID，多个用逗号分隔
        in: path
        name: ids
        required: true
        type: string
      responses:
        "200":
          description: OK
          schema:
            type: string
      security:
      - BearerAuth: []
      summary: 删除集群权限
  /admin/cluster_permissions/update_blacklist_namespaces/{id}:
    post:
      parameters:
      - description: 权限ID
        in: path
        name: id
        required: true
        type: integer
      responses:
        "200":
          description: OK
          schema:
            type: string
      security:
      - BearerAuth: []
      summary: 更新指定集群用户角色的黑名单命名空间字段
  /admin/cluster_permissions/update_namespaces/{id}:
    post:
      parameters:
      - description: 权限ID
        in: path
        name: id
        required: true
        type: integer
      responses:
        "200":
          description: OK
          schema:
            type: string
      security:
      - BearerAuth: []
      summary: 更新指定集群用户角色的命名空间字段
  /admin/cluster_permissions/user/{username}/list:
    get:
      parameters:
      - description: 用户名
        in: path
        name: username
        required: true
        type: string
      responses:
        "200":
          description: OK
          schema:
            type: string
      security:
      - BearerAuth: []
      summary: 获取指定用户已获得授权的集群
  /admin/condition/delete/{ids}:
    post:
      parameters:
      - description: 条件ID，多个用逗号分隔
        in: path
        name: ids
        required: true
        type: string
      responses:
        "200":
          description: OK
          schema:
            type: string
      security:
      - BearerAuth: []
      summary: 删除条件
  /admin/condition/list:
    get:
      responses:
        "200":
          description: OK
          schema:
            type: string
      security:
      - BearerAuth: []
      summary: 获取条件列表
  /admin/condition/save:
    post:
      responses:
        "200":
          description: OK
          schema:
            type: string
      security:
      - BearerAuth: []
      summary: 创建或更新条件
  /admin/condition/save/id/{id}/status/{status}:
    post:
      parameters:
      - description: 条件ID
        in: path
        name: id
        required: true
        type: integer
      - description: 状态，例如：true、false
        in: path
        name: status
        required: true
        type: string
      responses:
        "200":
          description: OK
          schema:
            type: string
      security:
      - BearerAuth: []
      summary: 快速保存条件状态
  /admin/config/all:
    get:
      responses:
        "200":
          description: OK
          schema:
            type: string
      security:
      - BearerAuth: []
      summary: 获取系统配置
  /admin/config/sso/delete/{ids}:
    post:
      parameters:
      - description: SSO配置ID，多个用逗号分隔
        in: path
        name: ids
        required: true
        type: string
      responses:
        "200":
          description: OK
          schema:
            type: string
      security:
      - BearerAuth: []
      summary: 删除SSO配置
  /admin/config/sso/list:
    get:
      responses:
        "200":
          description: OK
          schema:
            type: string
      security:
      - BearerAuth: []
      summary: 获取SSO配置列表
  /admin/config/sso/save:
    post:
      responses:
        "200":
          description: OK
          schema:
            type: string
      security:
      - BearerAuth: []
      summary: 创建或更新SSO配置
  /admin/config/sso/save/id/{id}/status/{enabled}:
    post:
      parameters:
      - description: SSO配置ID
        in: path
        name: id
        required: true
        type: integer
      - description: 状态，例如：true、false
        in: path
        name: enabled
        required: true
        type: string
      responses:
        "200":
          description: OK
          schema:
            type: string
      security:
      - BearerAuth: []
      summary: 快速更新SSO配置状态
  /admin/config/update:
    post:
      parameters:
      - description: 配置信息
        in: body
        name: config
        required: true
        schema:
          $ref: '#/definitions/models.Config'
      responses:
        "200":
          description: OK
          schema:
            type: string
      security:
      - BearerAuth: []
      summary: 更新系统配置
  /admin/inspection/event/status/option_list:
    get:
      responses:
        "200":
          description: OK
          schema:
            type: string
      security:
      - BearerAuth: []
      summary: 获取巡检事件状态选项列表
  /admin/inspection/record/list:
    get:
      description: 根据巡检计划ID获取对应的巡检记录列表
      parameters:
      - description: 巡检计划ID
        in: path
        name: id
        type: string
      responses:
        "200":
          description: OK
          schema:
            type: string
      security:
      - BearerAuth: []
      summary: 获取巡检记录列表
  /admin/inspection/schedule/delete/{ids}:
    post:
      parameters:
      - description: 巡检计划ID，多个用逗号分隔
        in: path
        name: ids
        required: true
        type: string
      responses:
        "200":
          description: OK
          schema:
            type: string
      security:
      - BearerAuth: []
      summary: 删除巡检计划
  /admin/inspection/schedule/id/{id}/summary/cluster/{cluster}/start_time/{start_time}/end_time/{end_time}:
    post:
      description: 统计指定巡检计划的执行情况，支持按时间范围和集群过滤
      parameters:
      - description: 巡检计划ID
        in: path
        name: id
        type: string
      - description: 集群名称
        in: path
        name: cluster
        type: string
      - description: 开始时间(RFC3339格式)
        in: path
        name: start_time
        type: string
      - description: 结束时间(RFC3339格式)
        in: path
        name: end_time
        type: string
      responses:
        "200":
          description: OK
          schema:
            type: string
      security:
      - BearerAuth: []
      summary: 统计巡检计划执行情况
  /admin/inspection/schedule/id/{id}/update_script_code:
    post:
      parameters:
      - description: 巡检计划ID
        in: path
        name: id
        required: true
        type: integer
      - description: 脚本代码
        in: body
        name: script_codes
        required: true
        schema:
          type: string
      responses:
        "200":
          description: OK
          schema:
            type: string
      security:
      - BearerAuth: []
      summary: 更新巡检脚本代码
  /admin/inspection/schedule/list:
    get:
      responses:
        "200":
          description: OK
          schema:
            type: string
      security:
      - BearerAuth: []
      summary: 获取巡检计划列表
  /admin/inspection/schedule/record/id/{id}/event/list:
    get:
      parameters:
      - description: 巡检记录ID
        in: path
        name: id
        required: true
        type: string
      responses:
        "200":
          description: OK
          schema:
            type: string
      security:
      - BearerAuth: []
      summary: 获取巡检事件列表
  /admin/inspection/schedule/record/id/{id}/output/list:
    get:
      parameters:
      - description: 巡检记录ID
        in: path
        name: id
        required: true
        type: string
      responses:
        "200":
          description: OK
          schema:
            type: string
      security:
      - BearerAuth: []
      summary: 获取巡检脚本输出列表
  /admin/inspection/schedule/record/id/{id}/push:
    post:
      description: 将指定巡检记录的AI总结推送到所有配置的Webhook接收器
      parameters:
      - description: 巡检记录ID
        in: path
        name: id
        required: true
        type: string
      responses:
        "200":
          description: OK
          schema:
            type: string
      security:
      - BearerAuth: []
      summary: 推送巡检记录
  /admin/inspection/schedule/record/id/{id}/summary:
    post:
      description: 为指定巡检记录生成AI总结
      parameters:
      - description: 巡检记录ID
        in: path
        name: id
        required: true
        type: string
      responses:
        "200":
          description: OK
          schema:
            type: string
      security:
      - BearerAuth: []
      summary: 生成巡检记录AI总结
  /admin/inspection/schedule/save:
    post:
      responses:
        "200":
          description: OK
          schema:
            type: string
      security:
      - BearerAuth: []
      summary: 保存巡检计划
  /admin/inspection/schedule/save/id/{id}/status/{enabled}:
    post:
      parameters:
      - description: 巡检计划ID
        in: path
        name: id
        required: true
        type: integer
      - description: 状态，例如：true、false
        in: path
        name: enabled
        required: true
        type: string
      responses:
        "200":
          description: OK
          schema:
            type: string
      security:
      - BearerAuth: []
      summary: 快速更新巡检计划状态
  /admin/inspection/schedule/start/id/{id}:
    post:
      parameters:
      - description: 巡检计划ID
        in: path
        name: id
        required: true
        type: integer
      responses:
        "200":
          description: OK
          schema:
            type: string
      security:
      - BearerAuth: []
      summary: 启动巡检计划
  /admin/inspection/script/delete/{ids}:
    post:
      parameters:
      - description: 脚本ID，多个用逗号分隔
        in: path
        name: ids
        required: true
        type: string
      responses:
        "200":
          description: OK
          schema:
            type: string
      security:
      - BearerAuth: []
      summary: 删除Lua脚本
  /admin/inspection/script/list:
    get:
      responses:
        "200":
          description: OK
          schema:
            type: string
      security:
      - BearerAuth: []
      summary: 获取Lua脚本列表
  /admin/inspection/script/load:
    post:
      responses:
        "200":
          description: OK
          schema:
            type: string
      security:
      - BearerAuth: []
      summary: 加载内置Lua脚本
  /admin/inspection/script/option_list:
    get:
      responses:
        "200":
          description: OK
          schema:
            type: string
      security:
      - BearerAuth: []
      summary: 获取Lua脚本选项列表
  /admin/inspection/script/save:
    post:
      responses:
        "200":
          description: OK
          schema:
            type: string
      security:
      - BearerAuth: []
      summary: 保存Lua脚本
  /admin/mcp/connect/{name}:
    post:
      parameters:
      - description: MCP服务器名称
        in: path
        name: name
        required: true
        type: string
      responses:
        "200":
          description: OK
          schema:
            type: string
      security:
      - BearerAuth: []
      summary: 连接指定MCP服务器
  /admin/mcp/delete:
    post:
      responses:
        "200":
          description: OK
          schema:
            type: string
      security:
      - BearerAuth: []
      summary: 删除MCP服务器
  /admin/mcp/list:
    get:
      responses:
        "200":
          description: OK
          schema:
            type: string
      security:
      - BearerAuth: []
      summary: 获取MCP服务器列表
  /admin/mcp/log/list:
    get:
      responses:
        "200":
          description: OK
          schema:
            type: string
      security:
      - BearerAuth: []
      summary: 获取MCP服务器日志列表
  /admin/mcp/save:
    post:
      responses:
        "200":
          description: OK
          schema:
            type: string
      security:
      - BearerAuth: []
      summary: 创建或更新MCP服务器
  /admin/mcp/save/id/{id}/status/{status}:
    post:
      parameters:
      - description: 服务器ID
        in: path
        name: id
        required: true
        type: integer
      - description: 状态，例如：true、false
        in: path
        name: status
        required: true
        type: string
      responses:
        "200":
          description: OK
          schema:
            type: string
      security:
      - BearerAuth: []
      summary: 快速保存MCP服务器状态
  /admin/mcp/server/{name}/tools/list:
    get:
      parameters:
      - description: MCP服务器名称
        in: path
        name: name
        required: true
        type: string
      responses:
        "200":
          description: OK
          schema:
            type: string
      security:
      - BearerAuth: []
      summary: 获取指定MCP服务器的工具列表
  /admin/mcp/tool/save/id/{id}/status/{status}:
    post:
      parameters:
      - description: 工具ID
        in: path
        name: id
        required: true
        type: integer
      - description: 状态，例如：true、false
        in: path
        name: status
        required: true
        type: string
      responses:
        "200":
          description: OK
          schema:
            type: string
      security:
      - BearerAuth: []
      summary: 快速保存MCP工具状态
  /admin/user/2fa/disable/{id}:
    post:
      description: 禁用指定用户的二步验证
      parameters:
      - description: 用户ID
        in: path
        name: id
        required: true
        type: string
      responses:
        "200":
          description: OK
          schema:
            type: string
      security:
      - BearerAuth: []
      summary: 禁用用户2FA
  /admin/user/delete/{ids}:
    post:
      description: 根据ID批量删除用户
      parameters:
      - description: 用户ID，多个用逗号分隔
        in: path
        name: ids
        required: true
        type: string
      responses:
        "200":
          description: OK
          schema:
            type: string
      security:
      - BearerAuth: []
      summary: 删除用户
  /admin/user/list:
    get:
      description: 获取所有用户信息
      responses:
        "200":
          description: OK
          schema:
            items:
              $ref: '#/definitions/models.User'
            type: array
      security:
      - BearerAuth: []
      summary: 获取用户列表
  /admin/user/save:
    post:
      consumes:
      - application/json
      description: 新增或更新用户信息
      parameters:
      - description: 用户信息
        in: body
        name: data
        required: true
        schema:
          $ref: '#/definitions/models.User'
      responses:
        "200":
          description: OK
          schema:
            additionalProperties: true
            type: object
      security:
      - BearerAuth: []
      summary: 保存用户
  /admin/user/update_psw/{id}:
    post:
      consumes:
      - application/json
      description: 根据ID更新用户密码
      parameters:
      - description: 用户ID
        in: path
        name: id
        required: true
        type: string
      - description: 新密码信息
        in: body
        name: data
        required: true
        schema:
          $ref: '#/definitions/models.User'
      responses:
        "200":
          description: OK
          schema:
            type: string
      security:
      - BearerAuth: []
      summary: 更新用户密码
  /admin/user_group/delete/{ids}:
    post:
      description: 根据ID批量删除用户组
      parameters:
      - description: 用户组ID，多个用逗号分隔
        in: path
        name: ids
        required: true
        type: string
      responses:
        "200":
          description: OK
          schema:
            type: string
      security:
      - BearerAuth: []
      summary: 删除用户组
  /admin/user_group/list:
    get:
      description: 获取所有用户组信息
      responses:
        "200":
          description: OK
          schema:
            items:
              $ref: '#/definitions/models.UserGroup'
            type: array
      security:
      - BearerAuth: []
      summary: 获取用户组列表
  /admin/user_group/option_list:
    get:
      description: 获取所有用户组的选项（仅ID和名称）
      responses:
        "200":
          description: OK
          schema:
            items:
              additionalProperties:
                type: string
              type: object
            type: array
      security:
      - BearerAuth: []
      summary: 用户组选项列表
  /admin/user_group/save:
    post:
      consumes:
      - application/json
      description: 新增或更新用户组信息
      parameters:
      - description: 用户组信息
        in: body
        name: data
        required: true
        schema:
          $ref: '#/definitions/models.UserGroup'
      responses:
        "200":
          description: OK
          schema:
            additionalProperties: true
            type: object
      security:
      - BearerAuth: []
      summary: 保存用户组
securityDefinitions:
  BearerAuth:
    in: header
    name: Authorization
    type: apiKey
swagger: "2.0"
